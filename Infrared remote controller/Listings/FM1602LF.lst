C51 COMPILER V9.00   FM1602LF                                                              03/21/2017 18:10:28 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE FM1602LF
OBJECT MODULE PLACED IN .\Objects\FM1602LF.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE module\FM1602LF.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\include;.\common;.\m
                    -odule) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\Listings\FM1602LF.lst) TABS(2) OBJECT(.\Objects\FM1602LF.obj)

line level    source

   1          #include  "FM1602LF.h"
   2          
   3          
   4          //定义端口
   5          sbit SDA_I2C_FM1602LF = P0^6; //RS为寄存器选择，高电平时选择数据寄存器、低电平时选择指令寄存器。
   6          sbit SCL_I2C_FM1602LF = P0^5; //R/W为读写信号线，高电平时进行读操作，低电平时进行写操作。
   7          sbit EN = P0^7; //E端为使能端，当E端由高电平跳变成低电平时，液晶模块执行命令。
   8          
   9          #define   FM1602LF_EEPROM_SLA     0x27
  10          #define   EEPROM_WR               0
  11          #define   EEPROM_RD               1
  12          
  13          #define RS_CLR RS=0 
  14          #define RS_SET RS=1
  15          
  16          #define RW_CLR RW=0 
  17          #define RW_SET RW=1 
  18          
  19          #define EN_CLR EN=0
  20          #define EN_SET EN=1
  21          
  22          
  23          //EX_extern void Init_FM1602LF_I2C(void);
  24          //EX_extern void writeChar_FM1602LF(UINT8 data_I2C);
  25          //EX_extern void LCD_Init(void);
  26          //EX_extern void LCD_Write_Com(unsigned char com) ;
  27          //EX_extern void DelayMs(unsigned char t);
  28          
  29          /*------------------------------------------------------
  30           mS延时函数
  31           含有输入参数 unsigned char t，无返回值
  32           unsigned char 是定义无符号字符变量，其值的范围是
  33           0~255 这里使用晶振16M，精确延时请使用汇编
  34          ------------------------------------------------------*/
  35          void DelayMs(unsigned char t)
  36          {
  37   1          uint8_t i=1334;
  38   1          while(t--)
  39   1          {
  40   2              //大致延时1mS
  41   2              while(i--);
  42   2          }
  43   1      }
  44          
  45          /*------------------------------------------------
  46                        I2C初始化函数
  47          ------------------------------------------------*/
  48          void Init_FM1602LF_I2C(void)
  49          {
  50   1          P05_OpenDrain_Mode;
  51   1          P06_OpenDrain_Mode;
  52   1          Init_I2C();                                 //set SDA and SCL pins high
  53   1      }
  54          
C51 COMPILER V9.00   FM1602LF                                                              03/21/2017 18:10:28 PAGE 2   

  55          /*------------------------------------------------
  56                       Send one byte
  57          ------------------------------------------------*/
  58          void writeChar_FM1602LF(UINT8 data_I2C)
  59          {
  60   1          start_I2C();
  61   1          writebyte_I2C(FM1602LF_EEPROM_SLA|EEPROM_WR);
  62   1          respons_I2C();
  63   1          writebyte_I2C(data_I2C);
  64   1          respons_I2C();
  65   1          stop_I2C();
  66   1      }
  67          
  68          /*------------------------------------------------
  69                        LCD初始化函数
  70          ------------------------------------------------*/
  71          void LCD_Init(void) 
  72          {
  73   1          LCD_Write_Com(0x38);    /*显示模式设置*/ 
  74   1          DelayMs(5); 
  75   1          LCD_Write_Com(0x38); 
  76   1          DelayMs(5); 
  77   1          LCD_Write_Com(0x38); 
  78   1          DelayMs(5); 
  79   1          LCD_Write_Com(0x38);  
  80   1          LCD_Write_Com(0x08);    /*显示关闭*/ 
  81   1          LCD_Write_Com(0x01);    /*显示清屏*/ 
  82   1          LCD_Write_Com(0x06);    /*显示光标移动设置*/ 
  83   1          DelayMs(5); 
  84   1          LCD_Write_Com(0x0C);    /*显示开及光标设置*/
  85   1      }
  86          
  87          /*------------------------------------------------------
  88                              写入命令函数
  89          ------------------------------------------------------*/
  90          void LCD_Write_Com(unsigned char com) 
  91          {  
  92   1      //    while(LCD_Check_Busy()); //忙则等待
  93   1      
  94   1      }
*** WARNING C280 IN LINE 90 OF MODULE\FM1602LF.C: 'com': unreferenced local variable
  95          
  96          /*------------------------------------------------------
  97                              写入数据函数
  98          ------------------------------------------------------*/
  99          void LCD_Write_Data(unsigned char Data) 
 100          { 
 101   1      //    while(LCD_Check_Busy()); //忙则等待
 102   1      
 103   1      }
*** WARNING C280 IN LINE 99 OF MODULE\FM1602LF.C: 'Data': unreferenced local variable
 104          
 105          
 106          /*------------------------------------------------------
 107                              清屏函数
 108          ------------------------------------------------------*/
 109          void LCD_Clear(void) 
 110          { 
 111   1          LCD_Write_Com(0x01); 
 112   1          DelayMs(5);
 113   1      }
 114          
C51 COMPILER V9.00   FM1602LF                                                              03/21/2017 18:10:28 PAGE 3   

 115          
 116          /*------------------------------------------------------
 117                              写入字符串函数
 118          ------------------------------------------------------*/
 119          void LCD_Write_String(unsigned char x,unsigned char y,unsigned char *s) 
 120          {     
 121   1          if (y == 0) 
 122   1          {     
 123   2              LCD_Write_Com(0x80 + x);     //表示第一行
 124   2          }
 125   1          else 
 126   1          {      
 127   2              LCD_Write_Com(0xC0 + x);      //表示第二行
 128   2          } 
 129   1      
 130   1          while (*s) 
 131   1          {     
 132   2              LCD_Write_Data( *s);     
 133   2              s ++;     
 134   2          }
 135   1      }
 136          
 137          /*------------------------------------------------------
 138                              写入字符函数
 139          ------------------------------------------------------*/
 140          void LCD_Write_Char(unsigned char x,unsigned char y,unsigned char Data) 
 141          {     
 142   1          if (y == 0) 
 143   1          {     
 144   2              LCD_Write_Com(0x80 + x);     
 145   2          }    
 146   1          else 
 147   1          {     
 148   2              LCD_Write_Com(0xC0 + x);     
 149   2          }
 150   1          
 151   1          LCD_Write_Data( Data);  
 152   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    178    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
