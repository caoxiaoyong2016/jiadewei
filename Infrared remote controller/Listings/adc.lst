C51 COMPILER V9.00   ADC                                                                   04/08/2017 00:23:15 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE ADC
OBJECT MODULE PLACED IN .\Objects\adc.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE module\adc.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\include;.\common;.\module
                    -) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\Listings\adc.lst) OBJECT(.\Objects\adc.obj)

line level    source

   1          #include "adc.h"
   2          
   3          /*************  本地变量声明    **************/
   4          UINT8   adc_count = 0;
   5          //UINT8 adc_data = 0;
   6          //UINT8 adc_V = 0;
   7          //bit           adc_V_flag = 0;
   8          
   9          //void Timer0_ISR_adc (void) interrupt 1 
  10          //{
  11          //      adc_data += adc_start();
  12          //      if(adc_count == times)
  13          //      {
  14          //              adc_V = adc_data/100;
  15          //              adc_count = 0;
  16          //              adc_V_flag = 1;
  17          //      }
  18          //      if(adc_V_flag)
  19          //      {
  20          //              if(adc_V < V_3_3)
  21          //              {
  22          //                      ST_BY = 0;
  23          //                      BT_POWER = 0;
  24          //              }
  25          //              else if(adc_V < V_3_5)
  26          //              {
  27          //                      LOW_BAT_NOTIFY = 0;
  28          //              }
  29          //              else
  30          //              {
  31          //                      LOW_BAT_NOTIFY = 1;
  32          //              }
  33          //      }
  34          //}
  35          UINT8   adc_start(void)
  36          {
  37   1              UINT8   adc_dat = 0;
  38   1              clr_ADCF;
  39   1              set_ADCS;
  40   1              while(ADCF == 0);
  41   1              adc_dat = ADCRH;
  42   1              adc_count++;
  43   1              return  adc_dat;
  44   1      }
  45          
  46          void    adc_init(void)
  47          {
  48   1              ADCCON0&=0xc0;          //AD转换启动AD标志完成
  49   1              AINDIDS=0x00;           
  50   1              AIN(AINx);                      //通道选择并配置
  51   1              ADCCON1|=SET_BIT0;      //ADC使能
  52   1      }
  53          
  54          void    AIN     (UINT8  adc_AINx)
C51 COMPILER V9.00   ADC                                                                   04/08/2017 00:23:15 PAGE 2   

  55          {
  56   1              switch(adc_AINx)
  57   1              {
  58   2                      case    AIN0:
  59   2                              ADCCON0 |= 0x00;
  60   2                              P17_Input_Mode;
  61   2                              AINDIDS|=SET_BIT0;
  62   2                              break;
  63   2                      
  64   2                      case    AIN1:
  65   2                              ADCCON0 |= 0x01;
  66   2                              P30_Input_Mode;
  67   2                              AINDIDS|=SET_BIT1;
  68   2                              break;
  69   2                      
  70   2                      case    AIN2:
  71   2                              ADCCON0 |= 0x02;
  72   2                              P07_Input_Mode;
  73   2                              AINDIDS|=SET_BIT2;
  74   2                              break;
  75   2                              
  76   2                      case    AIN3:
  77   2                              ADCCON0 |= 0x03;
  78   2                              P06_Input_Mode;
  79   2                              AINDIDS|=SET_BIT3;
  80   2                              break;
  81   2                              
  82   2                      case    AIN4:
  83   2                              ADCCON0 |= 0x04;
  84   2                              P05_Input_Mode;
  85   2                              AINDIDS|=SET_BIT4;
  86   2                              break;
  87   2                              
  88   2                      case    AIN5:
  89   2                              ADCCON0 |= 0x05;
  90   2                              P04_Input_Mode;
  91   2                              AINDIDS|=SET_BIT5;
  92   2                              break;
  93   2                              ;
  94   2                      case    AIN6:
  95   2                              ADCCON0 |= 0x06;
  96   2                              P03_Input_Mode;
  97   2                              AINDIDS|=SET_BIT6;
  98   2                              break;
  99   2                              
 100   2                      case    AIN7:
 101   2                              ADCCON0 |= 0x07;
 102   2                              P11_Input_Mode;
 103   2                              AINDIDS|=SET_BIT7;
 104   2                              break;
 105   2                              
 106   2                      default:
 107   2                              break;
 108   2              }
 109   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    169    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.00   ADC                                                                   04/08/2017 00:23:15 PAGE 3   

   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
