C51 COMPILER V9.00   BLUETOOTH                                                             04/13/2017 11:08:02 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE BLUETOOTH
OBJECT MODULE PLACED IN .\Output\bluetooth.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE src\bluetooth.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\src;.\include) DEFINE(
                    -FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\Listings\bluetooth.lst) OBJECT(.\Output\bluetooth.obj)

line level    source

   1          #include        "bluetooth.h"
   2          
   3          bit             sw_time1 = 0;
   4          bit             minutes_15_flag = 0;
   5          UINT8   minutes_num = 0;
   6          extern  bit             minute_1_flag;
   7          extern  bit             adc_V35_flag;
   8          
   9          void    Bluetooth_process(void)
  10          {
  11   1              UINT8   i=0,count=0,CMD=0;
  12   1              __delay_10ms(1);
  13   1      /***********Induction remote commands**************/
  14   1              if(CMD_PLAY)
  15   1              {
  16   2                      do
  17   2                      {
  18   3                              __delay_10ms(1);
  19   3                              count++;
  20   3                      }while(CMD_PLAY);
  21   2                      if(count>20)
  22   2                      {
  23   3                              CMD=__PLAY;     
  24   3                              Bluetooth_CMD(CMD);
  25   3                              count=0;
  26   3                      }
  27   2              }
  28   1              if(CMD_REV)
  29   1              {
  30   2                      do
  31   2                      {
  32   3                              __delay_10ms(1);
  33   3                              count++;
  34   3                      }while(CMD_REV);
  35   2                      if(count>20)
  36   2                      {
  37   3                              CMD=__REV;
  38   3                              Bluetooth_CMD(CMD);
  39   3                              count=0;
  40   3                      }
  41   2              }
  42   1              if(CMD_FWD)
  43   1              {
  44   2                      do
  45   2                      {
  46   3                              __delay_10ms(1);
  47   3                              count++;
  48   3                      }while(CMD_FWD);
  49   2                      if(count>20)
  50   2                      {
  51   3                              CMD=__FWD;
  52   3                              Bluetooth_CMD(CMD);
  53   3                              count=0;
  54   3                      }
C51 COMPILER V9.00   BLUETOOTH                                                             04/13/2017 11:08:02 PAGE 2   

  55   2              }
  56   1              if(CMD_VOL_UP)
  57   1              {
  58   2                      do
  59   2                      {
  60   3                              __delay_10ms(1);
  61   3                              count++;
  62   3                      }while(CMD_VOL_UP);
  63   2                      if(count>20)
  64   2                      {
  65   3                              CMD=__VOL_UP;
  66   3                              Bluetooth_CMD(CMD);
  67   3                              count=0;
  68   3                      }
  69   2              }
  70   1              if(CMD_VOL_DOWN)
  71   1              {
  72   2                      do
  73   2                      {
  74   3                              __delay_10ms(1);
  75   3                              count++;
  76   3                      }while(CMD_VOL_DOWN);
  77   2                      if(count>20)
  78   2                      {
  79   3                              CMD=__VOL_DOWN;
  80   3                              Bluetooth_CMD(CMD);
  81   3                              count=0;
  82   3                      }
  83   2              }
  84   1              if(CMD_PAIR)
  85   1              {
  86   2                      do
  87   2                      {
  88   3                              __delay_10ms(1);
  89   3                              count++;
  90   3                      }while(CMD_PAIR);
  91   2                      if(count>20)
  92   2                      {
  93   3                              CMD=__PAIR;
  94   3                              Bluetooth_CMD(CMD);
  95   3                              count=0;
  96   3                      }
  97   2              }       
  98   1      
  99   1      /***********Control the gesture switch**************/
 100   1              if(!adc_V35_flag)
 101   1              {
 102   2                      LOW_BAT_NOTIFY = 0;
 103   2              }
 104   1              else if(!BT_DET)
 105   1              {
 106   2                      LOW_BAT_NOTIFY = 0;
 107   2                      __delay_10ms(6);
 108   2                      LOW_BAT_NOTIFY = 1;
 109   2                      __delay_10ms(12);
 110   2                      LOW_BAT_NOTIFY = 0;
 111   2      //              __delay_10ms(6);
 112   2              }
 113   1              else
 114   1              {
 115   2                      LOW_BAT_NOTIFY = 1;
 116   2              }       
C51 COMPILER V9.00   BLUETOOTH                                                             04/13/2017 11:08:02 PAGE 3   

 117   1      /***********Detection of Bluetooth connection status**************/
 118   1              if(BT_DET)
 119   1              {
 120   2                      sw_time1 = 0;
 121   2                      minute_1_flag = 0;
 122   2                      minutes_15_flag = 0;
 123   2              }
 124   1              else
 125   1              {
 126   2                      if(!sw_time1)
 127   2                      {
 128   3                              set_TR1;        
 129   3                              sw_time1 = 1;
 130   3                      }
 131   2                      if(minute_1_flag)
 132   2                      {
 133   3                              set_TR1;
 134   3                              minutes_num++;
 135   3                              minute_1_flag = 0;
 136   3                              if(minutes_num>15)
 137   3                              {
 138   4                                      minutes_15_flag = 1;
 139   4                                      minutes_num = 0;
 140   4                              }
 141   3                      }//if(minute_1_flag)
 142   2                      if(minutes_15_flag)
 143   2                      {
 144   3                              minutes_15_flag = 0;
 145   3                              BT_POWER = 0;
 146   3                              __delay_10ms(50);
 147   3                              LOW_BAT_NOTIFY = 0;
 148   3                              ST_BY = 0;
 149   3                              clr_EA;
 150   3                              while(1)
 151   3                              {
 152   4                                      set_PD;                                         
 153   4                              }
 154   3                      }//if(minutes_15_flag)
 155   2              }//if(BT_DET)
 156   1      }
 157          
 158          void    Bluetooth_CMD(UINT8     cmd)
 159          {
 160   1              switch(cmd)
 161   1              {
 162   2                      case    __PLAY:
 163   2                              PLAY = 1;
 164   2                              __delay_10ms(25);
 165   2                              PLAY = 0;
 166   2                              break;
 167   2                      case    __REV:
 168   2                              REV = 1;
 169   2                              __delay_10ms(25);
 170   2                              REV = 0;
 171   2                              break;
 172   2                      case    __FWD:
 173   2                              FWD = 1;
 174   2                              __delay_10ms(25);
 175   2                              FWD = 0;
 176   2                              break;
 177   2                      case    __VOL_UP:
 178   2                              VOL_UP = 1;
C51 COMPILER V9.00   BLUETOOTH                                                             04/13/2017 11:08:02 PAGE 4   

 179   2      //                      P00 = 1;
 180   2                              __delay_10ms(25);
 181   2                              VOL_UP = 0;
 182   2      //                      P00 = 0;
 183   2      //                      while(1);
 184   2                              break;
 185   2                      case    __VOL_DOWN:
 186   2                              VOL_DOWN = 1;
 187   2      //                      P01 = 1;
 188   2                              __delay_10ms(25);
 189   2                              VOL_DOWN = 0;
 190   2      //                      P01 = 0;
 191   2      //                      while(1);
 192   2                              break;
 193   2                      case    __PAIR:
 194   2                              PAIR = 1;
 195   2                              __delay_10ms(25);
 196   2                              PAIR = 0;
 197   2                              break;
 198   2                      default:
 199   2                              break;
 200   2              }
 201   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    474    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
