C51 COMPILER V9.52.0.0   WDT                                                               07/21/2016 17:36:20 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE WDT
OBJECT MODULE PLACED IN .\Output\WDT.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Code\WDT.c BROWSE INCDIR(..\..\Include) DEFINE(FOSC_160000) DEBUG OBJECTEXT
                    -END PRINT(.\LST\WDT.lst) TABS(2) OBJECT(.\Output\WDT.obj)

line level    source

   1          /*--------------------------------------------------------------------------------------------------------
             --*/
   2          /*                                                                                                        
             - */
   3          /* Copyright(c) 2016 Nuvoton Technology Corp. All rights reserved.                                        
             - */
   4          /*                                                                                                        
             - */
   5          /*--------------------------------------------------------------------------------------------------------
             --*/
   6          
   7          //********************************************************************************************************
             -***
   8          //  Nuvoton Technoledge Corp. 
   9          //  Website: http://www.nuvoton.com
  10          //  E-Mail : MicroC-8bit@nuvoton.com
  11          //  Date   : Apr/21/2016
  12          //********************************************************************************************************
             -***
  13          
  14          //********************************************************************************************************
             -***
  15          //  File Function: N76E003 Watch Dog reste functiondemo code
  16          //********************************************************************************************************
             -***
  17          
  18          #include <stdio.h>
  19          #include "N76E003.h"
  20          #include "Define.h"
  21          #include "Common.h"
  22          #include "Delay.h"
  23          #include "SFR_Macro.h"
  24          #include "Function_define.h"
  25          
  26          /***********************************************************************
  27            WDT CONFIG enable 
  28            warning : this macro is only when ICP not enable CONFIG WDT function
  29            copy this marco code to you code to enable WDT reset.
  30          ************************************************************************/
  31          void Enable_WDT_Reset_Config(void)
  32          {
  33   1          set_IAPEN;
  34   1          IAPAL = 0x04;
  35   1          IAPAH = 0x00;
  36   1          IAPFD = 0x0F;
  37   1          IAPCN = 0xE1;
  38   1          set_CFUEN;
  39   1          set_IAPGO;                                  //trigger IAP
  40   1          while((CHPCON&SET_BIT6)==SET_BIT6);          //check IAPFF (CHPCON.6)
  41   1          clr_CFUEN;
  42   1          clr_IAPEN;
  43   1      }
  44          
  45          
C51 COMPILER V9.52.0.0   WDT                                                               07/21/2016 17:36:20 PAGE 2   

  46          /*********************************************************************************************************
             -***
  47          *    Main function 
  48          **********************************************************************************************************
             -**/
  49          void main (void)
  50          {
  51   1      
  52   1      
  53   1      
  54   1        Set_All_GPIO_Quasi_Mode;
  55   1      
  56   1        clr_GPIO1;
  57   1        Timer0_Delay1ms(50);          //toggle I/O to show MCU Reset
  58   1        set_GPIO1;
  59   1        Timer0_Delay1ms(50);
  60   1        clr_GPIO1;
  61   1        Timer0_Delay1ms(50);
  62   1        set_GPIO1;
  63   1        Timer0_Delay1ms(50);
  64   1      
  65   1        
  66   1      //----------------------------------------------------------------------------------------------
  67   1      // WDT Init
  68   1      // Warning:
  69   1      // Always check CONFIG WDT enable first, CONFIG not enable, SFR can't enable WDT reset
  70   1      // Please call Enable_WDT_Reset_Config() function to enable CONFIG WDT reset
  71   1      //----------------------------------------------------------------------------------------------
  72   1      
  73   1      //  Enable_WDT_Reset_Config();
  74   1      
  75   1          TA=0xAA;TA=0x55;WDCON=0x07;           //Setting WDT prescale 
  76   1          set_WDCLR;                            //Clear WDT timer
  77   1          while((WDCON|~SET_BIT6)==0xFF);       //confirm WDT clear is ok before into power down mode
  78   1          EA = 1;
  79   1          set_WDTR;                             //WDT run
  80   1          
  81   1          while(1)
  82   1          {
  83   2      
  84   2            clr_GPIO1;
  85   2            Timer0_Delay1ms(500);
  86   2            set_GPIO1;
  87   2            Timer0_Delay1ms(500);
  88   2            clr_GPIO1;
  89   2            Timer0_Delay1ms(500);
  90   2            set_GPIO1;
  91   2            Timer0_Delay1ms(500);
  92   2            set_PD;
  93   2          }
  94   1      }
  95          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    292    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
C51 COMPILER V9.52.0.0   WDT                                                               07/21/2016 17:36:20 PAGE 3   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
